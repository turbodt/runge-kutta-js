(function(n,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(n=typeof globalThis<"u"?globalThis:n||self,u(n.RKLib={}))})(this,(function(n){"use strict";class u{constructor(r){this.order=r,this.data=new Float64Array(this.order*this.order+this.order+this.order),this.a=[];for(let e=0;e<this.order;e++)this.a.push(this.data.subarray(e*this.order,(e+1)*this.order));this.b=this.data.subarray(this.order*this.order,this.order*(1+this.order)),this.c=this.data.subarray(this.order*(1+this.order),this.order*(2+this.order))}a;b;c;data;toString(){let r="";for(let e=0;e<this.order;e++)r+=`${this.c[e]} : `,r+=`${this.a[e].join(" ")}`,r+=`
`;return r+=`	 : ${this.b.join(" ")}
`,r}makeItConsistent(){return this.a.forEach((r,e)=>{this.c[e]=0;for(let a=0;a<this.order;a++)this.c[e]+=r[a]}),this}}class l{constructor(r,e){this.butcherTableau=r,this.f=e}get order(){return this.butcherTableau.order}stepInto(r,e,a,i){const o=new Array(this.order);for(let s=0;s<this.order;s++)o[s]=this.k(s,r,e,a,o);for(let s=0;s<this.order;s++)for(let h=0;h<a.length;h++)i[h]=r*this.butcherTableau.b[s]*o[s][h]+a[h];return this}step(r,e,a){const i=new Float64Array(a.length);return this.stepInto(r,e,a,i),i}stepsInto(r,e,a,i,o){for(let s=0;s<this.order;s++)o[s]=i[s];for(let s=0;s<r;s++)this.stepInto(e,a,o,o);return this}steps(r,e,a,i){const o=new Float64Array(i.length);return this.stepsInto(r,e,a,i,o),o}k(r,e,a,i,o){const s=i.slice();for(let h=0;h<r;h++)for(let d=0;d<i.length;d++)s[d]+=e*this.butcherTableau.a[r][h]*o[h][d];return this.f(a+e*this.butcherTableau.c[r],s)}}const t=new u(7);t.a[1][0]=1/5,t.a[2][0]=3/40,t.a[2][1]=9/40,t.a[3][0]=44/45,t.a[3][1]=-56/15,t.a[3][2]=32/9,t.a[4][0]=19372/6561,t.a[4][1]=-25360/2187,t.a[4][2]=64448/6561,t.a[4][3]=-212/729,t.a[5][0]=9017/3168,t.a[5][1]=-355/33,t.a[5][2]=46732/5247,t.a[5][3]=49/176,t.a[5][4]=-5103/18656,t.a[6][0]=35/384,t.a[6][1]=0,t.a[6][2]=500/1113,t.a[6][3]=125/192,t.a[6][4]=-2187/6784,t.a[6][5]=11/84,t.makeItConsistent(),t.b[0]=35/384,t.b[1]=0,t.b[2]=500/1113,t.b[3]=125/192,t.b[4]=-2187/6784,t.b[5]=11/84,t.b[6]=0,n.ButcherTableau=u,n.RungeKutta=l,n.rkdp45ButcherTableau=t,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
