(function(o,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(o=typeof globalThis<"u"?globalThis:o||self,n(o.RKLib={}))})(this,(function(o){"use strict";class n{constructor(e){this.order=e,this.data=new Float64Array(this.order*this.order+this.order+this.order),this.a=[];for(let r=0;r<this.order;r++)this.a.push(this.data.subarray(r*this.order,(r+1)*this.order));this.b=this.data.subarray(this.order*this.order,this.order*(1+this.order)),this.c=this.data.subarray(this.order*(1+this.order),this.order*(2+this.order))}a;b;c;data;toString(){let e="";for(let r=0;r<this.order;r++)e+=`${this.c[r]} : `,e+=`${this.a[r].join(" ")}`,e+=`
`;return e+=`	 : ${this.b.join(" ")}
`,e}makeItConsistent(){return this.a.forEach((e,r)=>{this.c[r]=0;for(let i=0;i<this.order;i++)this.c[r]+=e[i]}),this}}class d{constructor(e,r){this.butcherTableau=e,this.f=r,this.k=new Array(this.order)}k;get order(){return this.butcherTableau.order}stepInto(e,r,i,h){this.updateK(e,r,i);for(let a=0;a<i.length;a++){h[a]=i[a];for(let s=0;s<this.order;s++)h[a]+=e*this.butcherTableau.b[s]*this.k[s][a]}return this}step(e,r,i){const h=new Float64Array(i.length);return this.stepInto(e,r,i,h),h}stepsInto(e,r,i,h,a){for(let s=0;s<e;s++)this.stepInto(r,i,h,a);if(e===0)for(let s=0;s<h.length;s++)a[s]=h[s];return this}steps(e,r,i,h){const a=new Float64Array(h.length);return this.stepsInto(e,r,i,h,a),a}updateK(e,r,i){const h=new Float64Array(i.length);for(let a=0;a<this.order;a++){for(let s=0;s<i.length;s++){h[s]=0;for(let u=0;u<a;u++)h[s]+=this.butcherTableau.a[a][u]*this.k[u][s];h[s]*=e,h[s]+=i[s]}this.k[a]=this.f(r+e*this.butcherTableau.c[a],h)}}}const t=new n(7);t.a[1][0]=1/5,t.a[2][0]=3/40,t.a[2][1]=9/40,t.a[3][0]=44/45,t.a[3][1]=-56/15,t.a[3][2]=32/9,t.a[4][0]=19372/6561,t.a[4][1]=-25360/2187,t.a[4][2]=64448/6561,t.a[4][3]=-212/729,t.a[5][0]=9017/3168,t.a[5][1]=-355/33,t.a[5][2]=46732/5247,t.a[5][3]=49/176,t.a[5][4]=-5103/18656,t.a[6][0]=35/384,t.a[6][1]=0,t.a[6][2]=500/1113,t.a[6][3]=125/192,t.a[6][4]=-2187/6784,t.a[6][5]=11/84,t.makeItConsistent(),t.b[0]=35/384,t.b[1]=0,t.b[2]=500/1113,t.b[3]=125/192,t.b[4]=-2187/6784,t.b[5]=11/84,t.b[6]=0,o.ButcherTableau=n,o.RungeKutta=d,o.rkdp45ButcherTableau=t,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})}));
